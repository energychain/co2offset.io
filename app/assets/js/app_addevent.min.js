void 0===window.app&&(window.app={});const app=async function(){$("#searchFrm").submit((function(t){window.app.renderSearchResults(),t.preventDefault()})),$("#btnAddMeter").click((function(t){$("#addNewMeterModal").modal("show")})),$("#addMeterFrm").submit((function(t){!async function(t){await window.co2accounting.addMeter(t);location.reload()}({name:$("#meterName").val(),presafing:1*$("#meterPresafing").val(),co2eq:1*$("#meterFactor").val(),unit:$("#meterUnit").val(),scope:$("#meterScope").val(),category:$("#meterCategory").val(),reading:1*$("#meterReading").val(),timestamp:(new Date).getTime()}),t.preventDefault()})),$("#addReadingFrm").submit((function(t){!async function(t){await window.co2accounting.addMeteredReading(t);window.app.clearCache(),location.href="./index.html"}({meter:$("#readingMeterId").val(),reading:1*$("#meterReadingN").val(),timestamp:(new Date).getTime()}),t.preventDefault()})),$("#addEventFrm").submit((function(t){!async function(t){await window.co2accounting.settleEvent(t),window.app.clearCache(),location.href="./index.html"}({title:$("#addTitle").val(),qty:1*$("#addQty").val(),presafing:1*$("#addPresafing").val(),factor:1*$("#addFactor").val(),unit:$("#addUnit").val(),scope:$("#addScope").val(),category:$("#addCategory").val(),startTime:new Date($("#addStartTime").val()).getTime(),endTime:new Date($("#addEndTime").val()).getTime()}),t.preventDefault()})),$("#hdrInfo").hide(),$(".hdrinfo").hide(),$("#addEventButton").click((function(t){$("#addNewModal").modal("show"),$("#hdrModal").html('<h4 id="hdrModal" class="modal-title"><i class="fa fa-fire"></i>Â Add Emission Event</h4>'),t.preventDefault()})),$("#frmCreateWebForm").submit((function(t){location.href="./upsert.html?event="+$("#selectedEvent").val(),t.preventDefault()})),$(".quickBtn").click((function(t){$("#hdrModal").html($(this).html()),$("#addTitle").val($(this).attr("data-title")),$("#addQty").val(1*$(this).attr("data-qty")),$("#addPresafing").val($(this).attr("data-presafing")),$("#addFactor").val(1*$(this).attr("data-factor")),$("#addUnit").val($(this).attr("data-unit")),$("#addScope").val($(this).attr("data-scope")),$("#addCategory").val($(this).attr("data-category")),void 0!==$(this).attr("data-endTime")&&$("#addStartTime").val(new Date(1*$(this).attr("data-endTime")).toISOString().substr(0,16)),$("#addEndTime").val((new Date).toISOString().substr(0,16)),$("#addNewModal").modal("show")}));let t=await window.co2accounting.listEvents();for(let a=0;a<t.length;a++)for(let e=0;e<$(".quickBtn").length;e++)$($(".quickBtn")[e]).attr("data-scope")==t[a].scope&&$($(".quickBtn")[e]).attr("data-category")==t[a].category&&(void 0===$($(".quickBtn")[e]).attr("data-endTime")||1*$($(".quickBtn")[e]).attr("data-endTime")<t[a].endTime)&&($($(".quickBtn")[e]).attr("data-endTime",t[a].endTime),$($(".quickBtn")[e]).attr("data-factor",t[a].factor),$($(".quickBtn")[e]).attr("data-qty",t[a].qty),$($(".quickBtn")[e]).attr("data-unit",t[a].unit));for(let t=0;t<$(".quickBtn").length;t++)$($(".quickBtn")[t]).attr("data-endTime")||($($(".quickBtn")[t]).removeClass("btn-primary"),$($(".quickBtn")[t]).addClass("btn-danger"));await window.app.renderEvents();let a=await window.co2accounting.listMeters();for(let t=0;t<a.length;t++)$("#rowMeters").append('<div class="col text-center"><button class="btn btn-primary meterBtn" data-meter="'+a[t].meter+'" type="button" style="min-width: 185px;max-width: 185px;"><i class="fas fa-tachometer-alt fa-3x w-100"></i>'+a[t].name+"</button></div>");window.app._meters=a,$(".meterBtn").click((function(t){let a=window.app._meters[0];for(let t=0;t<window.app._meters.length;t++)window.app._meters[t].meter==$(this).attr("data-meter")&&(a=window.app._meters[t]);$("#readingUnit").val(a.unit),$("#readingName").val(a.name),$("#meterReadingN").val(a.reading),$("#readingMeterId").val(a.meter),$("#addNewReadingModal").modal("show")}))};